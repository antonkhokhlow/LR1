/*Создайте функцию, которая рассчитывает стоимость
каждой аренды (для каждой записи таблицы bookings).*/
USE cd;
DELIMITER //

DROP FUNCTION IF EXISTS rental_cost;
CREATE FUNCTION rental_cost(memid INT, facid INT, slots INT) RETURNS INT 
DETERMINISTIC
BEGIN
    DECLARE total_cost INT;

    SET total_cost = (SELECT IF(memid = 0, guestcost, membercost) * slots
                   FROM facilities
                   WHERE facid = facilities.facid);
                   
    RETURN total_cost;
    
END //

DELIMITER ;
SELECT rental_cost(memid, facid, slots) AS total_cost
FROM bookings;